import{K as P,a as f,r as t,j as e}from"./auth-BxfdJgsU.js";import{g as b,b as g}from"./Game-Dr9zSDgt.js";import"./vendor-Cs8wUaRe.js";import"./ethers-BBATp_Pg.js";import"./index-C3S8jdOc.js";const u=3,o={shield:{name:"Shield",icon:"ðŸ›¡ï¸",description:"+1 extra hit protection",price:"0.01 USDC"},speed:{name:"Speed Boost",icon:"âš¡",description:"+15% move speed in game",price:"0.005 USDC"},double:{name:"Double Damage",icon:"ðŸ’¥",description:"2x damage for 20 seconds",price:"0.02 USDC"}},k=({isOpen:l,onClose:m})=>{const{authenticated:w}=P(),{wallets:j}=f(),[p,h]=t.useState(!1),[d,a]=t.useState(null),[i,v]=t.useState({shields:0,speedBoosts:0,doubles:0,spent:"0"}),r=j[0];t.useEffect(()=>{l&&(r!=null&&r.address)&&x()},[l,r==null?void 0:r.address]);const x=async()=>{if(r!=null&&r.address)try{const s=await b(r.address);v(s)}catch(s){console.error("Failed to load powerups:",s)}},N=async s=>{if(!r){a("No wallet connected"),setTimeout(()=>a(null),3e3);return}if(!p){h(!0),a(`Purchasing ${o[s].name}...`);try{const c=await g(r,s,1,n=>{a(n)});a(`${o[s].name} purchased!`),await x(),setTimeout(()=>a(null),3e3)}catch(c){a(c.message||"Purchase failed"),setTimeout(()=>a(null),5e3)}finally{h(!1)}}};return l?e.jsx("div",{className:"powerup-overlay",onClick:m,children:e.jsxs("div",{className:"powerup-modal",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"powerup-header",children:[e.jsx("h2",{children:"POWERUP SHOP"}),e.jsx("button",{className:"powerup-close",onClick:m,children:"âœ•"})]}),w?e.jsxs("div",{className:"powerup-body",children:[e.jsxs("div",{className:"powerup-inventory",children:[e.jsx("span",{children:"Your Powerups:"}),e.jsxs("div",{className:"inventory-items",children:[e.jsxs("div",{className:"inv-item",children:["ðŸ›¡ï¸ ",i.shields]}),e.jsxs("div",{className:"inv-item",children:["âš¡ ",i.speedBoosts]}),e.jsxs("div",{className:"inv-item",children:["ðŸ’¥ ",i.doubles]})]})]}),e.jsx("div",{className:"powerup-grid",children:Object.keys(o).map(s=>{const c=s==="shield"?i.shields:s==="speed"?i.speedBoosts:i.doubles,n=c>=u;return e.jsxs("div",{className:`powerup-card ${n?"maxed":""}`,children:[e.jsx("div",{className:"powerup-icon",children:o[s].icon}),e.jsx("div",{className:"powerup-name",children:o[s].name}),e.jsx("div",{className:"powerup-desc",children:o[s].description}),e.jsxs("div",{className:"powerup-owned",children:[c,"/",u]}),e.jsx("div",{className:"powerup-price",children:o[s].price}),e.jsx("button",{className:"powerup-buy-btn",onClick:()=>N(s),disabled:p||!r||n,children:n?"MAX":p?"WAIT...":"BUY"})]},s)})}),d&&e.jsx("div",{className:`powerup-status ${d.includes("failed")||d.includes("error")?"error":""}`,children:d}),e.jsxs("div",{className:"powerup-note",children:["Powerups are stored onchain. Effects apply every game.",e.jsx("br",{}),"Max ",u," per type for balance."]})]}):e.jsx("div",{className:"powerup-body",children:e.jsx("p",{className:"powerup-notice",children:"Login to purchase powerups"})})]})}):null};export{k as default};
